# 最大化elasticsearch索引性能

## 存储硬件因素

如果你一直遵循正常的开发路径，那么可能一直在机器上或周围的一台或多台机器上玩ES。但是，当需要将ES部署到产品中时，应该考虑以下几点建议。没有什么是硬性规定; ES用于广泛的任务和令人眼花缭乱的机器。但是这些建议基于我们对生产集群的经验提供了良好的起点。

### 最佳实践
磁盘通常是任何现代服务器的瓶颈。ES大量使用磁盘，磁盘能够处理的吞吐量越大，节点就越稳定。这里有一些优化磁盘I/O的技巧:

- 如果你能负担得起ssd，它们比任何机械磁盘都要好得多。ssd支持的节点可以提高查询和索引性能。或者，如果使用机械磁盘，请尝试获得最快的磁盘(高性能服务器磁盘，15k RPM驱动器)。

- 使用RAID 0。条状RAID将增加磁盘I/O，明显的代价是，如果磁盘出现故障，数据就会丢失。ES已经支持高可用的服务，无需使用磁盘镜像。使用RAID 0是提高磁盘速度的有效方法，对于机械磁盘和SSD都是如此。

- 避免使用EFS，虽然EFS提供持久性、共享存储和增长/收缩，高性能。众所周知，这种文件系统会导致索引损坏，而且由于ES已经提供了分布式系统的高可用和数据冗余机制，所以无需引入EFS。

- 不要使用远程挂载设备，比如NFS或者SMB/CIFS。远程设备产生的延时会直接影响ES的性能

- 如果您在EC2上，请注意EBS。甚至ssd支持的ES选项也常常比本地实例存储慢。EBS对于运行一个小型集群(1-2个节点)运行良好，但不能承受较大的搜索和索引基础设施的负载。如果使用EBS，则利用提供的IOPS确保性能。

- 最后，避免网络连接存储(NAS)。人们经常声称他们的NAS解决方案比本地驱动器更快、更可靠。尽管有这些说法，我们从来没有见过NAS达到它的宣传。NAS通常较慢，显示更大的延迟，平均延迟的偏差更大，并且可能会发生单点故障。